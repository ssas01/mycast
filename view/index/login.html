<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>学IT - 后台管理系统</title>
    <!--路径是基于index.php写的-->
    <link rel="stylesheet" href="/public/assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/public/assets/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="/public/assets/nprogress/nprogress.css">
    <link rel="stylesheet" href="/public/less/index.css">
</head>
<body>
    <!-- 登录 -->
    <div class="login">
        <div class="login-wrap">
            <div class="avatar">
                <img src="./uploads/monkey.png" class="img-circle" alt="">
            </div>
            <form action="" class="col-xs-offset-1 col-xs-10" id="itcastLoginForm">
                <div class="input-group input-group-lg">
                    <span class="input-group-addon">
                        <i class="fa fa-user"></i>
                    </span>
                    <input type="text" class="form-control" placeholder="用户名" name="tc_name">
                </div>
                <div class="input-group input-group-lg">
                    <span class="input-group-addon">
                        <i class="fa fa-key"></i>
                    </span>
                    <input type="password" class="form-control" placeholder="密码" name="tc_pass">
                </div>
                <button type="submit" class="btn btn-lg btn-primary btn-block">登 录</button>
            </form>
        </div>
    </div>
    
    <script src="/public/assets/jquery/jquery.min.js"></script>
    <script src="/public/assets/jquery-cookie/jquery.cookie.js"></script>
    <script src="/public/assets/bootstrap/js/bootstrap.min.js"></script>
    <script>
        //页面登陆，当单击登陆的是否，发送请求
        $("#itcastLoginForm").submit(function () {
            //页面中是submit按钮，会调用form的提交。因此阻止form的提交，使用ajax提交。
            var data=$(this).serialize();
            $.ajax({
                //按照参考文献发送请求
                url:"/api/login",
                type:"post",
                data:data,
                dataType:"json",
                success:function (data) {
                    if (data.code==200) {
                        //需要的数据都存储在result中，使用JSON.stringfy将json对象化成字符串
                        var str=JSON.stringify(data.result);
                        //将字符串存储在cookie中
                        $.cookie('result', str, { expires: 7, path: '/' });

                        location.href="/index/index";

                    }
                }
            });
            return false;
        });
    </script>
</body>
</html>